\hypertarget{Quad_8h_source}{}\doxysection{Quad.\+h}
\label{Quad_8h_source}\index{core/Quad.h@{core/Quad.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Quad.h}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ *  Created on: 18 mai 2024}}
\DoxyCodeLine{5 \textcolor{comment}{ *      Author: esn}}
\DoxyCodeLine{6 \textcolor{comment}{ */}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#ifndef QUAD\_H\_}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#define QUAD\_H\_}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{13 \textcolor{comment}{//\#include <vector>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <unordered\_set>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}Particle3D.h"{}}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}Point3D.h"{}}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include "{}Printable.h"{}}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{comment}{/*}}
\DoxyCodeLine{20 \textcolor{comment}{ * \#\#\#\#\#\#\#\#}}
\DoxyCodeLine{21 \textcolor{comment}{ *  Quad :)}}
\DoxyCodeLine{22 \textcolor{comment}{ * \#\#\#\#\#\#\#\#}}
\DoxyCodeLine{23 \textcolor{comment}{ */}}
\DoxyCodeLine{24 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \textcolor{keyword}{class }\mbox{\hyperlink{classQuad}{Quad}} : \textcolor{keyword}{public} \mbox{\hyperlink{classPrintable}{Printable}} \{}
\DoxyCodeLine{25 \textcolor{keyword}{private}:}
\DoxyCodeLine{26     \mbox{\hyperlink{structPoint3D}{Point3D}}* m\_ppoint;                   \textcolor{comment}{// The center of the zone.}}
\DoxyCodeLine{27     \mbox{\hyperlink{structPoint3D}{Point3D}}* m\_pbarycenter;              \textcolor{comment}{// The center of mass given the repartition of the WeightedPoints in the zone.}}
\DoxyCodeLine{28     \textcolor{keywordtype}{bool} m\_delppoint;                   \textcolor{comment}{// If the point should be deleted.}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30     \mbox{\hyperlink{structLSN}{LSN}} m\_a;                         \textcolor{comment}{// Length of the zone's border.}}
\DoxyCodeLine{31     \mbox{\hyperlink{structLSN}{LSN}} m\_tot\_weight;                    \textcolor{comment}{// Total weight contained in this Quad.}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33     T* m\_pT;                            \textcolor{comment}{// The content of this square (NULL if nothing).}}
\DoxyCodeLine{34     \textcolor{comment}{//Particle3D* m\_pparticle;          // The content of this node.}}
\DoxyCodeLine{35 }
\DoxyCodeLine{36     \mbox{\hyperlink{classQuad}{Quad}}* m\_pTLTree;                    \textcolor{comment}{// Top Left corner : is NULL if nothing}}
\DoxyCodeLine{37     \mbox{\hyperlink{classQuad}{Quad}}* m\_pTRTree;                    \textcolor{comment}{// Top Right corner : is NULL if nothing}}
\DoxyCodeLine{38     \mbox{\hyperlink{classQuad}{Quad}}* m\_pBLTree;                    \textcolor{comment}{// Bottom Left corner : is NULL if nothing}}
\DoxyCodeLine{39     \mbox{\hyperlink{classQuad}{Quad}}* m\_pBRTree;                    \textcolor{comment}{// Bottom Right corner : is NULL if nothing}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m\_NB\_QUADS;     \textcolor{comment}{// Keeps track of the number of Quad created.}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{keyword}{public}:}
\DoxyCodeLine{44     \textcolor{keyword}{static} \mbox{\hyperlink{structLSN}{LSN}} m\_LIM\_A;                  \textcolor{comment}{// This indicates the limit at which we stop subdividing (useless)}}
\DoxyCodeLine{45     \textcolor{keyword}{static} \textcolor{keywordtype}{float} m\_ALPHA;               \textcolor{comment}{// The threshold m\_ALPHA=a/d (with a being the width of the zone and d the distance from the center of the quad) indicates at which point we can consider}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47     \mbox{\hyperlink{classQuad}{Quad}}(\textcolor{keyword}{const} \mbox{\hyperlink{structLSN}{LSN}}\& a, \textcolor{keyword}{const} \mbox{\hyperlink{structPoint3D}{Point3D}}\& p=\{\{0,0\},\{0,0\},\{0,0\}\});}
\DoxyCodeLine{48     \mbox{\hyperlink{classQuad}{Quad}}(\textcolor{keyword}{const} \mbox{\hyperlink{structLSN}{LSN}}\& a, \mbox{\hyperlink{structPoint3D}{Point3D}}* ppoint);}
\DoxyCodeLine{49     \textcolor{keyword}{virtual} \mbox{\hyperlink{classQuad}{\string~Quad}}();}
\DoxyCodeLine{50 }
\DoxyCodeLine{51     \mbox{\hyperlink{structLSN}{LSN}} getA() \textcolor{keyword}{const};}
\DoxyCodeLine{52     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} getNB\_QUADS() \textcolor{keyword}{const};}
\DoxyCodeLine{53     \textcolor{comment}{//float getAlpha();}}
\DoxyCodeLine{54     \textcolor{comment}{//void setAlpha(float\& alpha=0.5);}}
\DoxyCodeLine{55     std::unordered\_set<T*> getElements() \textcolor{keyword}{const};\textcolor{comment}{//Returns all the elements contained in the tree.}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57     \textcolor{keywordtype}{bool} insert(T* pT);}
\DoxyCodeLine{58     \textcolor{comment}{//void insert(Particle3D* ppart);}}
\DoxyCodeLine{59     \textcolor{keywordtype}{void} find(\textcolor{keyword}{const} T\& t, std::unordered\_set<\mbox{\hyperlink{classQuad}{Quad<T>}}*>\& pquads);\textcolor{comment}{// It adds to the list of Quads in parameter accordingly to the ratio m\_ALPHA}}
\DoxyCodeLine{60     \textcolor{keywordtype}{void} computeInverseSquareLawResultant(\textcolor{keyword}{const} T\& t, \mbox{\hyperlink{classVector3D}{Vector3D}}\& v) \textcolor{keyword}{const};}
\DoxyCodeLine{61     \textcolor{comment}{//std::set<T*> find(const Point3D\& point);}}
\DoxyCodeLine{62     T* search(\mbox{\hyperlink{structPoint3D}{Point3D}}* ppoint) \textcolor{keyword}{const};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64     std::string to\_string(\textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& spread=\textcolor{keyword}{false}, \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& full\_info=\textcolor{keyword}{false}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}\& indent=0) \textcolor{keyword}{const};\textcolor{comment}{// :)}}
\DoxyCodeLine{65     \textcolor{keywordtype}{void} print(\textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& spread=\textcolor{keyword}{false}, \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& full\_info=\textcolor{keyword}{false}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}\& indent=0) \textcolor{keyword}{const};\textcolor{comment}{// :)}}
\DoxyCodeLine{66 \};}
\DoxyCodeLine{67 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classQuad}{Quad<T>::m\_NB\_QUADS}}=0;}
\DoxyCodeLine{68 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \mbox{\hyperlink{structLSN}{LSN}} \mbox{\hyperlink{classQuad}{Quad<T>::m\_LIM\_A}}=\{1, 0\};}
\DoxyCodeLine{69 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \textcolor{keywordtype}{float} \mbox{\hyperlink{classQuad}{Quad<T>::m\_ALPHA}}=0.5;}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \textcolor{comment}{/*}}
\DoxyCodeLine{73 \textcolor{comment}{ * Constructor1}}
\DoxyCodeLine{74 \textcolor{comment}{ */}}
\DoxyCodeLine{75 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \mbox{\hyperlink{classQuad}{Quad<T>::Quad}}(\textcolor{keyword}{const} \mbox{\hyperlink{structLSN}{LSN}}\& a, \textcolor{keyword}{const} \mbox{\hyperlink{structPoint3D}{Point3D}}\& point) \{}
\DoxyCodeLine{76     m\_ppoint=\textcolor{keyword}{new} \mbox{\hyperlink{structPoint3D}{Point3D}}(point);}
\DoxyCodeLine{77     m\_pbarycenter=\textcolor{keyword}{new} \mbox{\hyperlink{structPoint3D}{Point3D}}(*m\_ppoint);}
\DoxyCodeLine{78     m\_delppoint=\textcolor{keyword}{true};}
\DoxyCodeLine{79 }
\DoxyCodeLine{80     m\_a=a;}
\DoxyCodeLine{81     m\_tot\_weight=0.;}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     m\_pT=NULL;}
\DoxyCodeLine{84 }
\DoxyCodeLine{85     m\_pTLTree=NULL;}
\DoxyCodeLine{86     m\_pTRTree=NULL;}
\DoxyCodeLine{87     m\_pBLTree=NULL;}
\DoxyCodeLine{88     m\_pBRTree=NULL;}
\DoxyCodeLine{89 }
\DoxyCodeLine{90     m\_NB\_QUADS++;}
\DoxyCodeLine{91 \}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \textcolor{comment}{/*}}
\DoxyCodeLine{94 \textcolor{comment}{ * Constructor2}}
\DoxyCodeLine{95 \textcolor{comment}{ */}}
\DoxyCodeLine{96 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \mbox{\hyperlink{classQuad}{Quad<T>::Quad}}(\textcolor{keyword}{const} \mbox{\hyperlink{structLSN}{LSN}}\& a, \mbox{\hyperlink{structPoint3D}{Point3D}}* ppoint) \{}
\DoxyCodeLine{97     m\_ppoint=ppoint;}
\DoxyCodeLine{98     m\_pbarycenter=\textcolor{keyword}{new} \mbox{\hyperlink{structPoint3D}{Point3D}}(*m\_ppoint);}
\DoxyCodeLine{99     m\_delppoint=\textcolor{keyword}{false};}
\DoxyCodeLine{100 }
\DoxyCodeLine{101     m\_a=a;}
\DoxyCodeLine{102     m\_tot\_weight=0.;}
\DoxyCodeLine{103 }
\DoxyCodeLine{104     m\_pT=NULL;}
\DoxyCodeLine{105 }
\DoxyCodeLine{106     m\_pTLTree=NULL;}
\DoxyCodeLine{107     m\_pTRTree=NULL;}
\DoxyCodeLine{108     m\_pBLTree=NULL;}
\DoxyCodeLine{109     m\_pBRTree=NULL;}
\DoxyCodeLine{110 }
\DoxyCodeLine{111     m\_NB\_QUADS++;}
\DoxyCodeLine{112 \}}
\DoxyCodeLine{113 }
\DoxyCodeLine{114 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \mbox{\hyperlink{classQuad}{Quad<T>::\string~Quad}}() \{}
\DoxyCodeLine{115     \textcolor{keywordflow}{if} (m\_delppoint)\{}
\DoxyCodeLine{116         \textcolor{keyword}{delete} m\_ppoint;}
\DoxyCodeLine{117     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{118         m\_ppoint=NULL;}
\DoxyCodeLine{119     \}}
\DoxyCodeLine{120     \textcolor{keyword}{delete} m\_pbarycenter;}
\DoxyCodeLine{121 }
\DoxyCodeLine{122     m\_pT=NULL;}
\DoxyCodeLine{123 }
\DoxyCodeLine{124     \textcolor{keywordflow}{if} (m\_pTLTree!=NULL)\{}
\DoxyCodeLine{125         \textcolor{keyword}{delete} m\_pTLTree;}
\DoxyCodeLine{126     \}}
\DoxyCodeLine{127     \textcolor{keywordflow}{if} (m\_pTRTree!=NULL)\{}
\DoxyCodeLine{128         \textcolor{keyword}{delete} m\_pTRTree;}
\DoxyCodeLine{129     \}}
\DoxyCodeLine{130     \textcolor{keywordflow}{if} (m\_pBLTree!=NULL)\{}
\DoxyCodeLine{131         \textcolor{keyword}{delete} m\_pBLTree;}
\DoxyCodeLine{132     \}}
\DoxyCodeLine{133     \textcolor{keywordflow}{if} (m\_pBRTree!=NULL)\{}
\DoxyCodeLine{134         \textcolor{keyword}{delete} m\_pBRTree;}
\DoxyCodeLine{135     \}}
\DoxyCodeLine{136 \}}
\DoxyCodeLine{137 }
\DoxyCodeLine{138 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \mbox{\hyperlink{structLSN}{LSN}} \mbox{\hyperlink{classQuad}{Quad<T>::getA}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{139     \textcolor{keywordflow}{return} m\_a;}
\DoxyCodeLine{140 \}}
\DoxyCodeLine{141 }
\DoxyCodeLine{142 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classQuad}{Quad<T>::getNB\_QUADS}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{143     \textcolor{keywordflow}{return} m\_NB\_QUADS;}
\DoxyCodeLine{144 \}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> std::unordered\_set<T*> \mbox{\hyperlink{classQuad}{Quad<T>::getElements}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{147     std::unordered\_set<T*> elmts;}
\DoxyCodeLine{148 }
\DoxyCodeLine{149     \textcolor{keywordflow}{if} (m\_pT!=NULL)\{}
\DoxyCodeLine{150         elmts.insert(m\_pT);}
\DoxyCodeLine{151     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{152         \textcolor{keywordflow}{if} (m\_pTLTree==NULL)\{}
\DoxyCodeLine{153             \textcolor{keywordflow}{for} (T* pt : m\_pTLTree-\/>getElements())\{}
\DoxyCodeLine{154                 elmts.insert(pt);}
\DoxyCodeLine{155             \}}
\DoxyCodeLine{156         \}}
\DoxyCodeLine{157         \textcolor{keywordflow}{if} (m\_pTRTree==NULL)\{}
\DoxyCodeLine{158             \textcolor{keywordflow}{for} (T* pt : m\_pTRTree-\/>getElements())\{}
\DoxyCodeLine{159                 elmts.insert(pt);}
\DoxyCodeLine{160             \}}
\DoxyCodeLine{161         \}}
\DoxyCodeLine{162         \textcolor{keywordflow}{if} (m\_pBLTree==NULL)\{}
\DoxyCodeLine{163             \textcolor{keywordflow}{for} (T* pt : m\_pBLTree-\/>getElements())\{}
\DoxyCodeLine{164                 elmts.insert(pt);}
\DoxyCodeLine{165             \}}
\DoxyCodeLine{166         \}}
\DoxyCodeLine{167         \textcolor{keywordflow}{if} (m\_pBRTree==NULL)\{}
\DoxyCodeLine{168             \textcolor{keywordflow}{for} (T* pt : m\_pBRTree-\/>getElements())\{}
\DoxyCodeLine{169                 elmts.insert(pt);}
\DoxyCodeLine{170             \}}
\DoxyCodeLine{171         \}}
\DoxyCodeLine{172     \}}
\DoxyCodeLine{173 }
\DoxyCodeLine{174 }
\DoxyCodeLine{175     \textcolor{keywordflow}{return} elmts;}
\DoxyCodeLine{176 \}}
\DoxyCodeLine{177 }
\DoxyCodeLine{178 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \textcolor{keywordtype}{bool} \mbox{\hyperlink{classQuad}{Quad<T>::insert}}(T* pT) \{}
\DoxyCodeLine{179     \textcolor{keywordflow}{if} (pT!=NULL)\{}
\DoxyCodeLine{180         \mbox{\hyperlink{structPoint3D}{Point3D}} p=\{pT-\/>x, pT-\/>y, \{0, 0\}\textcolor{comment}{/*ppart-\/>z*/}\};}
\DoxyCodeLine{181         \mbox{\hyperlink{structPoint3D}{Point3D}} dp=\{pT-\/>x-\/m\_ppoint-\/>x, pT-\/>y-\/m\_ppoint-\/>y, \{0, 0\}\};}
\DoxyCodeLine{182 }
\DoxyCodeLine{183         \textcolor{keywordflow}{if} (abs(dp.x)<=m\_a/2 \&\& abs(dp.y)<=m\_a/2)\{\textcolor{comment}{// If in the square centered on the point.}}
\DoxyCodeLine{184             \textcolor{keywordflow}{if} (m\_pT==NULL)\{        \textcolor{comment}{// If empty}}
\DoxyCodeLine{185                 \textcolor{comment}{//printf("{}Empty\(\backslash\)n"{});}}
\DoxyCodeLine{186                 \textcolor{keywordflow}{if} (m\_pBLTree==NULL and m\_pBRTree==NULL and m\_pTRTree==NULL and m\_pTLTree==NULL)\{   \textcolor{comment}{// If the square has no Quads under (external branch)}}
\DoxyCodeLine{187                     m\_pT=pT;\textcolor{comment}{//We add in}}
\DoxyCodeLine{188                     m\_tot\_weight=1.;\textcolor{comment}{//Set the tot\_weight}}
\DoxyCodeLine{189                     *m\_pbarycenter=p;\textcolor{comment}{//Set the barycenter}}
\DoxyCodeLine{190                 \}\textcolor{keywordflow}{else}\{                                                                              \textcolor{comment}{// Else it means it is an internal branch}}
\DoxyCodeLine{191 }
\DoxyCodeLine{192                     m\_tot\_weight+=1.;\textcolor{comment}{//Add to tot\_weight}}
\DoxyCodeLine{193                     *m\_pbarycenter+=p*(1./m\_tot\_weight);\textcolor{comment}{//Add to the barycenter}}
\DoxyCodeLine{194 }
\DoxyCodeLine{195                     \textcolor{keywordflow}{if} (dp.x<=0. \&\& dp.y<=0.)\{\textcolor{comment}{//If square 1}}
\DoxyCodeLine{196                         \textcolor{comment}{//printf("{}Square1\(\backslash\)n"{});}}
\DoxyCodeLine{197                         \textcolor{keywordflow}{if} (m\_pBLTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{198                             \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{199                             \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a*-\/1,a*-\/1,\{0, 0\}\};}
\DoxyCodeLine{200                             std::cout<<\textcolor{stringliteral}{"{}1"{}}<<np.to\_string(\textcolor{keyword}{true});}
\DoxyCodeLine{201                             m\_pBLTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<T>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{202                         \}}
\DoxyCodeLine{203                         m\_pBLTree-\/>insert(pT);}
\DoxyCodeLine{204                     \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x>=0. \&\& dp.y<=0.)\{\textcolor{comment}{//If square 2}}
\DoxyCodeLine{205                         \textcolor{comment}{//printf("{}Square2\(\backslash\)n"{});}}
\DoxyCodeLine{206                         \textcolor{keywordflow}{if} (m\_pBRTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{207                             \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{208                             \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a,a*-\/1,\{0, 0\}\};}
\DoxyCodeLine{209                             std::cout<<\textcolor{stringliteral}{"{}2"{}}<<np.to\_string(\textcolor{keyword}{true});}
\DoxyCodeLine{210                             m\_pBRTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<T>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{211                         \}}
\DoxyCodeLine{212                         m\_pBRTree-\/>insert(pT);}
\DoxyCodeLine{213                     \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x>=0. \&\& dp.y>=0.)\{\textcolor{comment}{//If square 3}}
\DoxyCodeLine{214                         \textcolor{comment}{//printf("{}Square3\(\backslash\)n"{});}}
\DoxyCodeLine{215                         \textcolor{keywordflow}{if} (m\_pTRTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{216                             \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{217                             \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a,a,\{0, 0\}\};}
\DoxyCodeLine{218                             std::cout<<\textcolor{stringliteral}{"{}3"{}}<<np.to\_string(\textcolor{keyword}{true});}
\DoxyCodeLine{219                             m\_pTRTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<T>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{220                         \}}
\DoxyCodeLine{221                         m\_pTRTree-\/>insert(pT);}
\DoxyCodeLine{222                     \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x<=0. \&\& dp.y>=0.)\{\textcolor{comment}{//If square 4}}
\DoxyCodeLine{223                         \textcolor{comment}{//printf("{}Square4\(\backslash\)n"{});}}
\DoxyCodeLine{224                         \textcolor{keywordflow}{if} (m\_pTLTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{225                             \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{226                             \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a*-\/1,a,\{0, 0\}\};}
\DoxyCodeLine{227                             std::cout<<\textcolor{stringliteral}{"{}4"{}}<<np.to\_string(\textcolor{keyword}{true});}
\DoxyCodeLine{228                             m\_pTLTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<T>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{229                         \}}
\DoxyCodeLine{230                         m\_pTLTree-\/>insert(pT);}
\DoxyCodeLine{231                     \}}
\DoxyCodeLine{232                 \}}
\DoxyCodeLine{233             \}\textcolor{keywordflow}{else}\{                  \textcolor{comment}{// Else if full}}
\DoxyCodeLine{234 }
\DoxyCodeLine{235                 m\_tot\_weight=1.;\textcolor{comment}{//Set the tot\_weight}}
\DoxyCodeLine{236                 *m\_pbarycenter=p;\textcolor{comment}{//Set the barycenter}}
\DoxyCodeLine{237 }
\DoxyCodeLine{238                 \textcolor{comment}{//printf("{}Full\(\backslash\)n"{});}}
\DoxyCodeLine{239                 \textcolor{keywordflow}{if} (dp.x<=0. \&\& dp.y<=0.)\{\textcolor{comment}{//If square 1}}
\DoxyCodeLine{240                     \textcolor{comment}{//printf("{}Square1\(\backslash\)n"{});}}
\DoxyCodeLine{241                     \textcolor{keywordflow}{if} (m\_pBLTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{242                         \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{243                         \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a*-\/1,a*-\/1,\{0, 0\}\};}
\DoxyCodeLine{244                         std::cout<<\textcolor{stringliteral}{"{}5"{}}<<np.to\_string(\textcolor{keyword}{true});}
\DoxyCodeLine{245                         m\_pBLTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<T>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{246                     \}}
\DoxyCodeLine{247                     m\_pBLTree-\/>insert(pT);}
\DoxyCodeLine{248                 \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x>=0. \&\& dp.y<=0.)\{\textcolor{comment}{//If square 2}}
\DoxyCodeLine{249                     \textcolor{comment}{//printf("{}Square2\(\backslash\)n"{});}}
\DoxyCodeLine{250                     \textcolor{keywordflow}{if} (m\_pBRTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{251                         \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{252                         \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a,a*-\/1,\{0, 0\}\};}
\DoxyCodeLine{253                         std::cout<<\textcolor{stringliteral}{"{}6"{}}<<np.to\_string(\textcolor{keyword}{true});}
\DoxyCodeLine{254                         m\_pBRTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<T>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{255                     \}}
\DoxyCodeLine{256                     m\_pBRTree-\/>insert(pT);}
\DoxyCodeLine{257                 \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x>=0. \&\& dp.y>=0.)\{\textcolor{comment}{//If square 3}}
\DoxyCodeLine{258                     \textcolor{comment}{//printf("{}Square3\(\backslash\)n"{});}}
\DoxyCodeLine{259                     \textcolor{keywordflow}{if} (m\_pTRTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{260                         \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{261                         \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a,a,\{0, 0\}\};}
\DoxyCodeLine{262                         std::cout<<\textcolor{stringliteral}{"{}7"{}}<<np.to\_string(\textcolor{keyword}{true});}
\DoxyCodeLine{263                         m\_pTRTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<T>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{264                     \}}
\DoxyCodeLine{265                     m\_pTRTree-\/>insert(pT);}
\DoxyCodeLine{266                 \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x<=0. \&\& dp.y>=0.)\{\textcolor{comment}{//If square 4}}
\DoxyCodeLine{267                     \textcolor{comment}{//printf("{}Square4\(\backslash\)n"{});}}
\DoxyCodeLine{268                     \textcolor{keywordflow}{if} (m\_pTLTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{269                         \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{270                         \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a*-\/1,a,\{0, 0\}\};}
\DoxyCodeLine{271                         std::cout<<\textcolor{stringliteral}{"{}8"{}}<<np.to\_string(\textcolor{keyword}{true});}
\DoxyCodeLine{272                         m\_pTLTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<T>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{273                     \}}
\DoxyCodeLine{274                     m\_pTLTree-\/>insert(pT);}
\DoxyCodeLine{275                 \}}
\DoxyCodeLine{276                 \textcolor{comment}{// We reinsert the object already present.}}
\DoxyCodeLine{277                 T* pT2=m\_pT;}
\DoxyCodeLine{278                 m\_pT=NULL;}
\DoxyCodeLine{279                 this-\/>insert(pT2);}
\DoxyCodeLine{280             \}}
\DoxyCodeLine{281         \}}
\DoxyCodeLine{282     \}}
\DoxyCodeLine{283     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{284 \}}
\DoxyCodeLine{285 }
\DoxyCodeLine{286 \textcolor{keyword}{template}<> \textcolor{keywordtype}{bool} \mbox{\hyperlink{classQuad}{Quad<Particle3D>::insert}}(\mbox{\hyperlink{classParticle3D}{Particle3D}}* ppart) \{}
\DoxyCodeLine{287     \textcolor{keywordflow}{if} (ppart!=NULL)\{}
\DoxyCodeLine{288         \mbox{\hyperlink{structPoint3D}{Point3D}} p=\{ppart-\/>x, ppart-\/>y, \{0, 0\}\};\textcolor{comment}{//ppart-\/>z}}
\DoxyCodeLine{289         \mbox{\hyperlink{structPoint3D}{Point3D}} dp=\{ppart-\/>x-\/m\_ppoint-\/>x, ppart-\/>y-\/m\_ppoint-\/>y, \{0, 0\}\};}
\DoxyCodeLine{290 }
\DoxyCodeLine{291         \textcolor{keywordflow}{if} (abs(dp.x)<=m\_a/2 \&\& abs(dp.y)<=m\_a/2)\{\textcolor{comment}{// If in the square centered on the point.}}
\DoxyCodeLine{292             \textcolor{keywordflow}{if} (m\_pT==NULL)\{        \textcolor{comment}{// If empty}}
\DoxyCodeLine{293                 \textcolor{comment}{//printf("{}Empty\(\backslash\)n"{});}}
\DoxyCodeLine{294                 \textcolor{keywordflow}{if} (m\_pBLTree==NULL and m\_pBRTree==NULL and m\_pTRTree==NULL and m\_pTLTree==NULL)\{   \textcolor{comment}{// If the square has no Quads under (external branch)}}
\DoxyCodeLine{295                     m\_pT=ppart;\textcolor{comment}{//We add in}}
\DoxyCodeLine{296                     m\_tot\_weight=ppart-\/>w;\textcolor{comment}{//Set the tot\_weight}}
\DoxyCodeLine{297                     *m\_pbarycenter=p;\textcolor{comment}{//Set the barycenter}}
\DoxyCodeLine{298                 \}\textcolor{keywordflow}{else}\{                                                                              \textcolor{comment}{// Else it means it is an internal branch}}
\DoxyCodeLine{299 }
\DoxyCodeLine{300                     m\_tot\_weight+=ppart-\/>w;\textcolor{comment}{//Add to tot\_weight}}
\DoxyCodeLine{301                     \textcolor{comment}{//LSN k=ppart-\/>w/m\_tot\_weight;}}
\DoxyCodeLine{302                     \textcolor{keywordflow}{if} (m\_tot\_weight!=\mbox{\hyperlink{structLSN}{LSN}}\{0,0\})\{}
\DoxyCodeLine{303                         *m\_pbarycenter+=p*(ppart-\/>w/m\_tot\_weight);\textcolor{comment}{//Add to the barycenter}}
\DoxyCodeLine{304                     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{305                         *m\_pbarycenter=*m\_ppoint;\textcolor{comment}{//Set the barycenter to the geometric center}}
\DoxyCodeLine{306                     \}}
\DoxyCodeLine{307 }
\DoxyCodeLine{308 }
\DoxyCodeLine{309                     \textcolor{keywordflow}{if} (dp.x<=0. \&\& dp.y<=0.)\{\textcolor{comment}{//If square 1}}
\DoxyCodeLine{310                         \textcolor{comment}{//printf("{}Square1\(\backslash\)n"{});}}
\DoxyCodeLine{311                         \textcolor{keywordflow}{if} (m\_pBLTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{312                             \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{313                             \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a*-\/1,a*-\/1,\{0, 0\}\};}
\DoxyCodeLine{314                             m\_pBLTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<Particle3D>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{315                         \}}
\DoxyCodeLine{316                         m\_pBLTree-\/>insert(ppart);}
\DoxyCodeLine{317                     \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x>=0. \&\& dp.y<=0.)\{\textcolor{comment}{//If square 2}}
\DoxyCodeLine{318                         \textcolor{comment}{//printf("{}Square2\(\backslash\)n"{});}}
\DoxyCodeLine{319                         \textcolor{keywordflow}{if} (m\_pBRTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{320                             \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{321                             \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a,a*-\/1,\{0, 0\}\};}
\DoxyCodeLine{322                             m\_pBRTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<Particle3D>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{323                         \}}
\DoxyCodeLine{324                         m\_pBRTree-\/>insert(ppart);}
\DoxyCodeLine{325                     \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x>=0. \&\& dp.y>=0.)\{\textcolor{comment}{//If square 3}}
\DoxyCodeLine{326                         \textcolor{comment}{//printf("{}Square3\(\backslash\)n"{});}}
\DoxyCodeLine{327                         \textcolor{keywordflow}{if} (m\_pTRTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{328                             \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{329                             \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a,a,\{0, 0\}\};}
\DoxyCodeLine{330                             m\_pTRTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<Particle3D>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{331                         \}}
\DoxyCodeLine{332                         m\_pTRTree-\/>insert(ppart);}
\DoxyCodeLine{333                     \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x<=0. \&\& dp.y>=0.)\{\textcolor{comment}{//If square 4}}
\DoxyCodeLine{334                         \textcolor{comment}{//printf("{}Square4\(\backslash\)n"{});}}
\DoxyCodeLine{335                         \textcolor{keywordflow}{if} (m\_pTLTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{336                             \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{337                             \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a*-\/1,a,\{0, 0\}\};}
\DoxyCodeLine{338                             m\_pTLTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<Particle3D>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{339                         \}}
\DoxyCodeLine{340                         m\_pTLTree-\/>insert(ppart);}
\DoxyCodeLine{341                     \}}
\DoxyCodeLine{342                 \}}
\DoxyCodeLine{343             \}\textcolor{keywordflow}{else}\{                  \textcolor{comment}{// Else if full}}
\DoxyCodeLine{344 }
\DoxyCodeLine{345                 m\_tot\_weight=ppart-\/>w;\textcolor{comment}{//+m\_pT-\/>w//Set the tot\_weight}}
\DoxyCodeLine{346                 *m\_pbarycenter=p;\textcolor{comment}{//Set the barycenter}}
\DoxyCodeLine{347 }
\DoxyCodeLine{348                 \textcolor{comment}{//printf("{}Full\(\backslash\)n"{});}}
\DoxyCodeLine{349                 \textcolor{keywordflow}{if} (dp.x<=0. \&\& dp.y<=0.)\{\textcolor{comment}{//If square 1}}
\DoxyCodeLine{350                     \textcolor{comment}{//printf("{}Square1\(\backslash\)n"{});}}
\DoxyCodeLine{351                     \textcolor{keywordflow}{if} (m\_pBLTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{352                         \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{353                         \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a*-\/1,a*-\/1,\{0, 0\}\};}
\DoxyCodeLine{354                         m\_pBLTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<Particle3D>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{355                     \}}
\DoxyCodeLine{356                     m\_pBLTree-\/>insert(ppart);}
\DoxyCodeLine{357                 \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x>=0. \&\& dp.y<=0.)\{\textcolor{comment}{//If square 2}}
\DoxyCodeLine{358                     \textcolor{comment}{//printf("{}Square2\(\backslash\)n"{});}}
\DoxyCodeLine{359                     \textcolor{keywordflow}{if} (m\_pBRTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{360                         \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{361                         \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a,a*-\/1,\{0, 0\}\};}
\DoxyCodeLine{362                         m\_pBRTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<Particle3D>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{363                     \}}
\DoxyCodeLine{364                     m\_pBRTree-\/>insert(ppart);}
\DoxyCodeLine{365                 \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x>=0. \&\& dp.y>=0.)\{\textcolor{comment}{//If square 3}}
\DoxyCodeLine{366                     \textcolor{comment}{//printf("{}Square3\(\backslash\)n"{});}}
\DoxyCodeLine{367                     \textcolor{keywordflow}{if} (m\_pTRTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{368                         \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{369                         \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a,a,\{0, 0\}\};}
\DoxyCodeLine{370                         m\_pTRTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<Particle3D>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{371                     \}}
\DoxyCodeLine{372                     m\_pTRTree-\/>insert(ppart);}
\DoxyCodeLine{373                 \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dp.x<=0. \&\& dp.y>=0.)\{\textcolor{comment}{//If square 4}}
\DoxyCodeLine{374                     \textcolor{comment}{//printf("{}Square4\(\backslash\)n"{});}}
\DoxyCodeLine{375                     \textcolor{keywordflow}{if} (m\_pTLTree==NULL)\{\textcolor{comment}{//If there is not yet a tree we create it}}
\DoxyCodeLine{376                         \mbox{\hyperlink{structLSN}{LSN}} a=m\_a/4;}
\DoxyCodeLine{377                         \mbox{\hyperlink{structPoint3D}{Point3D}} np\{a*-\/1,a,\{0, 0\}\};}
\DoxyCodeLine{378                         m\_pTLTree=\textcolor{keyword}{new} \mbox{\hyperlink{classQuad}{Quad<Particle3D>}}(m\_a/2, *m\_ppoint+np);}
\DoxyCodeLine{379                     \}}
\DoxyCodeLine{380                     m\_pTLTree-\/>insert(ppart);}
\DoxyCodeLine{381                 \}}
\DoxyCodeLine{382                 \textcolor{comment}{// We redistribute the object already present in the Quad.}}
\DoxyCodeLine{383                 \mbox{\hyperlink{classParticle3D}{Particle3D}}* pT2=m\_pT;}
\DoxyCodeLine{384                 m\_pT=NULL;}
\DoxyCodeLine{385                 this-\/>insert(pT2);}
\DoxyCodeLine{386             \}}
\DoxyCodeLine{387         \}}
\DoxyCodeLine{388     \}}
\DoxyCodeLine{389     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{390 \}}
\DoxyCodeLine{391 }
\DoxyCodeLine{392 \textcolor{comment}{/*}}
\DoxyCodeLine{393 \textcolor{comment}{ * Stores the quads that are to be considered given alpha.}}
\DoxyCodeLine{394 \textcolor{comment}{ */}}
\DoxyCodeLine{395 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \textcolor{keywordtype}{void} \mbox{\hyperlink{classQuad}{Quad<T>::find}}(\textcolor{keyword}{const} T\& t, std::unordered\_set<\mbox{\hyperlink{classQuad}{Quad<T>}}*>\& pquads) \{}
\DoxyCodeLine{396     \mbox{\hyperlink{structPoint3D}{Point3D}} p=\{t.x, t.y, \{0, 0\}\};}
\DoxyCodeLine{397 }
\DoxyCodeLine{398     \mbox{\hyperlink{structLSN}{LSN}} s=this-\/>m\_a;}
\DoxyCodeLine{399     \mbox{\hyperlink{structLSN}{LSN}} d=getDistance(p, *m\_pbarycenter);}
\DoxyCodeLine{400     \mbox{\hyperlink{structLSN}{LSN}} alpha=s/d;}
\DoxyCodeLine{401     \textcolor{comment}{//std::cout<<"{}\(\backslash\)n"{}<<alpha.to\_string()<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{402 }
\DoxyCodeLine{403     \textcolor{keywordflow}{if} (alpha>=m\_ALPHA)\{}
\DoxyCodeLine{404         pquads.insert(\textcolor{keyword}{this});}
\DoxyCodeLine{405     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{406         \textcolor{keywordflow}{if} (m\_pBLTree!=NULL)\{}
\DoxyCodeLine{407             m\_pBLTree-\/>find(t, pquads);}
\DoxyCodeLine{408         \}}
\DoxyCodeLine{409         \textcolor{keywordflow}{if} (m\_pBRTree!=NULL)\{}
\DoxyCodeLine{410             m\_pBRTree-\/>find(t, pquads);}
\DoxyCodeLine{411         \}}
\DoxyCodeLine{412         \textcolor{keywordflow}{if} (m\_pTRTree!=NULL)\{}
\DoxyCodeLine{413             m\_pTRTree-\/>find(t, pquads);}
\DoxyCodeLine{414         \}}
\DoxyCodeLine{415         \textcolor{keywordflow}{if} (m\_pTLTree!=NULL)\{}
\DoxyCodeLine{416             m\_pTLTree-\/>find(t, pquads);}
\DoxyCodeLine{417         \}}
\DoxyCodeLine{418     \}}
\DoxyCodeLine{419 \}}
\DoxyCodeLine{420 }
\DoxyCodeLine{421 \textcolor{comment}{/*}}
\DoxyCodeLine{422 \textcolor{comment}{ * Usefull to simulate the effects of gravitation or electromagnetic interactions}}
\DoxyCodeLine{423 \textcolor{comment}{ */}}
\DoxyCodeLine{424 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \textcolor{keywordtype}{void} \mbox{\hyperlink{classQuad}{Quad<T>::computeInverseSquareLawResultant}}(\textcolor{keyword}{const} T\& t, \mbox{\hyperlink{classVector3D}{Vector3D}}\& v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{425     \textcolor{keywordflow}{if} (\&t!=m\_pT)\{}
\DoxyCodeLine{426         \mbox{\hyperlink{structPoint3D}{Point3D}} p=\{t.x, t.y, \{0, 0\}\};}
\DoxyCodeLine{427 }
\DoxyCodeLine{428         \mbox{\hyperlink{structLSN}{LSN}} s=this-\/>m\_a;}
\DoxyCodeLine{429         \mbox{\hyperlink{structLSN}{LSN}} d=getDistance(p, *m\_pbarycenter);}
\DoxyCodeLine{430         \mbox{\hyperlink{structLSN}{LSN}} alpha=s/d;}
\DoxyCodeLine{431         \textcolor{comment}{//std::cout<<"{}\(\backslash\)n"{}<<alpha.to\_string()<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{432 }
\DoxyCodeLine{433         \textcolor{keywordflow}{if} (alpha>=m\_ALPHA)\{}
\DoxyCodeLine{434             \mbox{\hyperlink{classVector3D}{Vector3D}}* pdv=\textcolor{keyword}{new} \mbox{\hyperlink{classVector3D}{Vector3D}}(p, *m\_pbarycenter);\textcolor{comment}{//ERROR}}
\DoxyCodeLine{435             \textcolor{comment}{//Vector3D dv;//ERROR}}
\DoxyCodeLine{436             \textcolor{comment}{//Vector3D dv(p, *m\_pbarycenter);//ERROR}}
\DoxyCodeLine{437             \textcolor{comment}{//std::cout << "{}\(\backslash\)n"{} << dv.to\_string(true, true) << "{}\(\backslash\)n"{};}}
\DoxyCodeLine{438             \textcolor{comment}{//Line3D l;}}
\DoxyCodeLine{439             \textcolor{comment}{//std::cout<<"{}\(\backslash\)n"{}<<l.to\_string(true, true)<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{440 }
\DoxyCodeLine{441             \textcolor{comment}{//Vector3D dv;//ERROR}}
\DoxyCodeLine{442             \textcolor{comment}{//dv.setP2(Point3D\{\{0,0\},\{0,0\},\{0,0\}\});}}
\DoxyCodeLine{443             \mbox{\hyperlink{structLSN}{LSN}} nb=t.w*this-\/>m\_tot\_weight;}
\DoxyCodeLine{444             \mbox{\hyperlink{structLSN}{LSN}} nb2=nb/pow(d, 2);}
\DoxyCodeLine{445             pdv-\/>setNorm(nb2);}
\DoxyCodeLine{446 }
\DoxyCodeLine{447             \textcolor{comment}{//std::cout<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{448             \textcolor{comment}{//dv.print(true, 0, true);}}
\DoxyCodeLine{449             \textcolor{comment}{//std::cout<<"{}\(\backslash\)n"{}<<dv.to\_string()<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{450             v+=*pdv;}
\DoxyCodeLine{451             \textcolor{comment}{//std::cout<<"{}\(\backslash\)n"{}<<v.to\_string()<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{452         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{453             \textcolor{keywordflow}{if} (m\_pBLTree!=NULL)\{}
\DoxyCodeLine{454                 m\_pBLTree-\/>computeInverseSquareLawResultant(t, v);}
\DoxyCodeLine{455             \}}
\DoxyCodeLine{456             \textcolor{keywordflow}{if} (m\_pBRTree!=NULL)\{}
\DoxyCodeLine{457                 m\_pBRTree-\/>computeInverseSquareLawResultant(t, v);}
\DoxyCodeLine{458             \}}
\DoxyCodeLine{459             \textcolor{keywordflow}{if} (m\_pTRTree!=NULL)\{}
\DoxyCodeLine{460                 m\_pTRTree-\/>computeInverseSquareLawResultant(t, v);}
\DoxyCodeLine{461             \}}
\DoxyCodeLine{462             \textcolor{keywordflow}{if} (m\_pTLTree!=NULL)\{}
\DoxyCodeLine{463                 m\_pTLTree-\/>computeInverseSquareLawResultant(t, v);}
\DoxyCodeLine{464             \}}
\DoxyCodeLine{465         \}}
\DoxyCodeLine{466     \}}
\DoxyCodeLine{467 \}}
\DoxyCodeLine{468 }
\DoxyCodeLine{469 \textcolor{comment}{/*template <typename T> std::set<T*> Quad<T>::find(const Point3D\& point) \{}}
\DoxyCodeLine{470 \textcolor{comment}{    ;}}
\DoxyCodeLine{471 \textcolor{comment}{\}*/}}
\DoxyCodeLine{472 }
\DoxyCodeLine{473 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> T* \mbox{\hyperlink{classQuad}{Quad<T>::search}}(\mbox{\hyperlink{structPoint3D}{Point3D}}* ppoint)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{474     T* pT=NULL;}
\DoxyCodeLine{475 }
\DoxyCodeLine{476     \textcolor{keywordflow}{if} (ppoint!=NULL)\{}
\DoxyCodeLine{477         \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} delta\_x=(\textcolor{keywordtype}{long} double)(ppoint-\/>x-\/m\_ppoint-\/>x);}
\DoxyCodeLine{478         \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} delta\_y=(\textcolor{keywordtype}{long} double)(ppoint-\/>y-\/m\_ppoint-\/>y);}
\DoxyCodeLine{479 }
\DoxyCodeLine{480         \textcolor{keywordflow}{if} (abs(delta\_x)<m\_a/2 \&\& abs(delta\_y)<m\_a/2)\{\textcolor{comment}{//If in the square centered on the point.}}
\DoxyCodeLine{481 }
\DoxyCodeLine{482             \textcolor{keywordflow}{if} (m\_pT!=NULL)\{\textcolor{comment}{// This means it is a square of the smallest size possible.}}
\DoxyCodeLine{483                 pT=m\_pT;}
\DoxyCodeLine{484             \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{485                 \textcolor{keywordflow}{if} (m\_pTLTree!=NULL)\{}
\DoxyCodeLine{486                     pT=m\_pTLTree-\/>search(ppoint);}
\DoxyCodeLine{487                 \}}
\DoxyCodeLine{488                 \textcolor{keywordflow}{if} (pT==NULL)\{\textcolor{comment}{//If it hasn't been initiated by the precedent line}}
\DoxyCodeLine{489                     \textcolor{keywordflow}{if} (m\_pTRTree!=NULL)\{}
\DoxyCodeLine{490                         pT=m\_pTRTree-\/>search(ppoint);}
\DoxyCodeLine{491                     \}}
\DoxyCodeLine{492                     \textcolor{keywordflow}{if} (pT==NULL)\{\textcolor{comment}{//If it hasn't been initiated by the precedent line}}
\DoxyCodeLine{493                         \textcolor{keywordflow}{if} (m\_pBLTree!=NULL)\{}
\DoxyCodeLine{494                             pT=m\_pBLTree-\/>search(ppoint);}
\DoxyCodeLine{495                         \}}
\DoxyCodeLine{496                         \textcolor{keywordflow}{if} (pT==NULL)\{\textcolor{comment}{//If it hasn't been initiated by the precedent line}}
\DoxyCodeLine{497                             \textcolor{keywordflow}{if} (m\_pBRTree!=NULL)\{}
\DoxyCodeLine{498                                 pT=m\_pBRTree-\/>search(ppoint);}
\DoxyCodeLine{499                             \}}
\DoxyCodeLine{500                         \}}
\DoxyCodeLine{501                     \}}
\DoxyCodeLine{502                 \}}
\DoxyCodeLine{503             \}}
\DoxyCodeLine{504         \}}
\DoxyCodeLine{505     \}}
\DoxyCodeLine{506 }
\DoxyCodeLine{507     \textcolor{keywordflow}{return} pT;}
\DoxyCodeLine{508 \}}
\DoxyCodeLine{509 }
\DoxyCodeLine{510 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> std::string \mbox{\hyperlink{classQuad}{Quad<T>::to\_string}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& spread, \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& full\_info, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}\& indent)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{511     std::string mes=((spread)?\textcolor{stringliteral}{"{}\(\backslash\)n"{}} : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{512     mes+=((spread)?to\_stringTabs(indent) : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{513     \textcolor{comment}{//mes+="{}QUAD"{};}}
\DoxyCodeLine{514 }
\DoxyCodeLine{515     \textcolor{comment}{//if (full\_info)\{}}
\DoxyCodeLine{516         mes+=\textcolor{stringliteral}{"{}QUAD["{}};}
\DoxyCodeLine{517         mes+=\textcolor{stringliteral}{"{}p, "{}};                                 \textcolor{comment}{//Pointer}}
\DoxyCodeLine{518         \textcolor{comment}{//mes+="{}\(\backslash\)n"{};}}
\DoxyCodeLine{519         mes+=m\_a.to\_string();                       \textcolor{comment}{//a}}
\DoxyCodeLine{520         mes+=\textcolor{stringliteral}{"{}, "{}};}
\DoxyCodeLine{521         mes+=m\_ppoint-\/>to\_string(\textcolor{keyword}{false}, \textcolor{keyword}{false});     \textcolor{comment}{//Point}}
\DoxyCodeLine{522         mes+=\textcolor{stringliteral}{"{}, "{}};}
\DoxyCodeLine{523         mes+=m\_pbarycenter-\/>to\_string(\textcolor{keyword}{false}, \textcolor{keyword}{false});        \textcolor{comment}{//Barycenter}}
\DoxyCodeLine{524         mes+=\textcolor{stringliteral}{"{}, "{}};}
\DoxyCodeLine{525         mes+=(m\_pT==NULL) ? \textcolor{stringliteral}{"{}NULL"{}} : std::to\_string((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long})(\textcolor{keywordtype}{void}**)m\_pT);}
\DoxyCodeLine{526         mes+=\textcolor{stringliteral}{"{}, "{}};}
\DoxyCodeLine{527         mes+=\textcolor{stringliteral}{"{}w:"{}} + std::to\_string(m\_tot\_weight.to\_long\_double());}
\DoxyCodeLine{528         mes+=\textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{529         mes+=((spread)?\textcolor{stringliteral}{"{}\(\backslash\)n"{}} : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{530     \textcolor{comment}{//\}}}
\DoxyCodeLine{531 }
\DoxyCodeLine{532     mes+=((spread)?to\_stringTabs(indent+1) : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{533     \textcolor{comment}{//mes+=(m\_pT==NULL) ? "{}NULL"{} : std::to\_string((unsigned long long)(void**)m\_pT);}}
\DoxyCodeLine{534     \textcolor{comment}{//mes+="{}, "{};}}
\DoxyCodeLine{535     \textcolor{comment}{//mes+=std::to\_string(m\_tot\_weight.to\_long\_double());}}
\DoxyCodeLine{536     \textcolor{comment}{//mes+="{}, "{};}}
\DoxyCodeLine{537     \textcolor{keywordflow}{if} (full\_info)\{}
\DoxyCodeLine{538         mes+=\textcolor{stringliteral}{"{}("{}};}
\DoxyCodeLine{539         \textcolor{comment}{//std::string nulll=to\_stringTabs(indent+1);}}
\DoxyCodeLine{540         std::string nulll=((spread)?\textcolor{stringliteral}{"{}\(\backslash\)n"{}} : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{541         nulll+=((spread)?to\_stringTabs(indent+1) : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{542         nulll+=\textcolor{stringliteral}{"{}NULL"{}};}
\DoxyCodeLine{543         nulll+=\textcolor{stringliteral}{"{}, "{}};}
\DoxyCodeLine{544         \textcolor{comment}{//nulll+=((spread)?"{}\(\backslash\)n"{} : "{}"{});}}
\DoxyCodeLine{545 }
\DoxyCodeLine{546         \textcolor{comment}{//mes+=(m\_pTLTree==NULL)?nulll : m\_pTLTree-\/>to\_string(spread, indent, full\_info)+"{}, "{};}}
\DoxyCodeLine{547         \textcolor{comment}{//mes+=(m\_pTRTree==NULL)?nulll : m\_pTRTree-\/>to\_string(spread, indent, full\_info)+"{}, "{};}}
\DoxyCodeLine{548         \textcolor{comment}{//mes+=(m\_pBLTree==NULL)?nulll : m\_pBLTree-\/>to\_string(spread, indent, full\_info)+"{}, "{};}}
\DoxyCodeLine{549         \textcolor{comment}{//mes+=(m\_pBRTree==NULL)?nulll : m\_pBRTree-\/>to\_string(spread, indent, full\_info)+"{}, "{};}}
\DoxyCodeLine{550         mes+=(m\_pTLTree==NULL)?nulll : m\_pTLTree-\/>to\_string(spread, indent+1, full\_info);}
\DoxyCodeLine{551         mes+=((spread)?to\_stringTabs(indent+1) : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{552         \textcolor{comment}{//mes+="{}, "{};}}
\DoxyCodeLine{553         mes+=(m\_pTRTree==NULL)?nulll : m\_pTRTree-\/>to\_string(spread, indent+1, full\_info);}
\DoxyCodeLine{554         mes+=((spread)?to\_stringTabs(indent+1) : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{555         \textcolor{comment}{//mes+="{}, "{};}}
\DoxyCodeLine{556         mes+=(m\_pBLTree==NULL)?nulll : m\_pBLTree-\/>to\_string(spread, indent+1, full\_info);}
\DoxyCodeLine{557         mes+=((spread)?to\_stringTabs(indent+1) : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{558         \textcolor{comment}{//mes+="{}, "{};}}
\DoxyCodeLine{559         mes+=(m\_pBRTree==NULL)?nulll : m\_pBRTree-\/>to\_string(spread, indent+1, full\_info);}
\DoxyCodeLine{560         \textcolor{comment}{//mes+=to\_stringTabs(indent+1);}}
\DoxyCodeLine{561         \textcolor{comment}{//mes+="{}, "{};}}
\DoxyCodeLine{562 }
\DoxyCodeLine{563 }
\DoxyCodeLine{564         mes.erase(mes.length()-\/2);}
\DoxyCodeLine{565         mes+=((spread)?\textcolor{stringliteral}{"{}\(\backslash\)n"{}} : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{566         mes+=((spread)?to\_stringTabs(indent+1) : \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{567         mes+=\textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{568     \}}
\DoxyCodeLine{569 }
\DoxyCodeLine{570     \textcolor{keywordflow}{return} mes;}
\DoxyCodeLine{571 \}}
\DoxyCodeLine{572 }
\DoxyCodeLine{573 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T> \textcolor{keywordtype}{void} \mbox{\hyperlink{classQuad}{Quad<T>::print}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& spread, \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& full\_info, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}\& indent)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{574     printTabs(indent);}
\DoxyCodeLine{575     std::cout << to\_string(spread, full\_info, indent);}
\DoxyCodeLine{576 \}}
\DoxyCodeLine{577 }
\DoxyCodeLine{578 }
\DoxyCodeLine{579 }
\DoxyCodeLine{580 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* QUAD\_H\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
